{"version":3,"sources":["../../../../../test/lib/metrics/local/metric_factory.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_counter","require","_counter2","_interopRequireDefault","_gauge","_gauge2","_timer","_timer2","_backend","_backend2","obj","__esModule","default","_classCallCheck","instance","TypeError","LocalFactory","_uniqueNameWithTags","name","tags","kvPairs","sortedKeys","keys","sort","hasOwnProperty","push","tagName","join","metricName","createCounter","arguments","undefined","uniqueMetricName","createTimer","createGauge"],"mappings":"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","file":"metric_factory.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n// Copyright (c) 2016 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nvar _counter = require('./counter');\n\nvar _counter2 = _interopRequireDefault(_counter);\n\nvar _gauge = require('./gauge');\n\nvar _gauge2 = _interopRequireDefault(_gauge);\n\nvar _timer = require('./timer');\n\nvar _timer2 = _interopRequireDefault(_timer);\n\nvar _backend = require('./backend');\n\nvar _backend2 = _interopRequireDefault(_backend);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LocalFactory = function () {\n    function LocalFactory() {\n        _classCallCheck(this, LocalFactory);\n\n        this._backend = new _backend2.default();\n    }\n\n    _createClass(LocalFactory, [{\n        key: '_uniqueNameWithTags',\n        value: function _uniqueNameWithTags(name, tags) {\n            var kvPairs = [];\n            var sortedKeys = Object.keys(tags).sort();\n            for (var i = 0; i < sortedKeys.length; i++) {\n                var key = sortedKeys[i];\n                var value = tags[key];\n                if (tags.hasOwnProperty(key)) {\n                    kvPairs.push(key + '=' + value);\n                }\n            }\n\n            var tagName = kvPairs.join();\n            var metricName = name + '.' + tagName;\n            return metricName;\n        }\n    }, {\n        key: 'createCounter',\n        value: function createCounter(name) {\n            var tags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n            var uniqueMetricName = this._uniqueNameWithTags(name, tags);\n            return new _counter2.default(uniqueMetricName, tags, this._backend);\n        }\n    }, {\n        key: 'createTimer',\n        value: function createTimer(name) {\n            var tags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n            var uniqueMetricName = this._uniqueNameWithTags(name, tags);\n            return new _timer2.default(uniqueMetricName, tags, this._backend);\n        }\n    }, {\n        key: 'createGauge',\n        value: function createGauge(name) {\n            var tags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n            var uniqueMetricName = this._uniqueNameWithTags(name, tags);\n            return new _gauge2.default(uniqueMetricName, tags, this._backend);\n        }\n    }]);\n\n    return LocalFactory;\n}();\n\nexports.default = LocalFactory;\n//# sourceMappingURL=metric_factory.js.map"]}